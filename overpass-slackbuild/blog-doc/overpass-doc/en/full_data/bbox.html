<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml">
<head><meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
pre { background-color:#ccffff; padding: 0.5em; counter-reset: line; }
div[type=sibling] { text-indent:1em; }
codeline::before { counter-increment: line; content: counter(line)" "; color: #99cccc; }
</style>
  <title>Bounding Boxes</title>
</head>
<body style="font-family:sans-serif; max-width:32em">

<p><a href="../index.html">Overpass API User's Manual</a>  </p>

<nav>
<div type="parent"><a href="../preface/index.html">Preface</a></div>
<div type="parent"><a href="../targets/index.html">Downstream Tools</a></div>
<div type="parent"><strong><a href="index.html">Spatial Data Selection</a></strong></div>

<div type="sibling"><strong> Bounding Boxes</strong></div>
<div type="sibling"><a href="osm_types.html">Geometries</a></div>
<div type="sibling"><a href="map_apis.html">Further Map APIs</a></div>
<div type="sibling"><a href="polygon.html">Polygon and Around</a></div>
<div type="sibling"><a href="area.html">Filter by area</a></div>
<div type="sibling"><a href="other_sources.html">Other sources</a></div>

</nav>
<div type="parent"><a href="../criteria/index.html">Find Objects</a></div>
<div type="parent"><a href="../counting/index.html">Counting Objects</a></div>
<div type="parent"><a href="../analysis/index.html">Analysing data</a></div>
<div type="parent"><a href="../more_info/index.html">More information</a></div>

<hr />

<h1>Bounding Boxes</h1>

<p>The simplest way to obtain OpenStreetMap data from a small region.</p>

<nav>
<h3>Content</h3>

<div type="subsection"><a href="bbox.html#filter">Filter a Query</a></div>
<div type="subsection"><a href="bbox.html#crop">Crop Output</a></div>
<div type="subsection"><a href="bbox.html#global">Filter Globally</a></div>

</nav>

<p><a name="filter"/></p>

<h2>Filter a Query</h2>

<p>The simplest way to get all data from a bounding box
is to explicitly state so <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=16&amp;Q=nwr%2851%2E477%2C%2D0%2E001%2C51%2E478%2C0%2E001%29%3B%0Aout%3B">(Link)</a>:</p>

<pre>
<codeline>nwr(51.477,-0.001,51.478,0.001);</codeline>
<codeline>out;</codeline>
</pre>

<p>Here <code>(51.477,-0.001,51.478,0.001)</code> represents the bounding box.
The order of the edges is always the same:</p>

<ul>
<li><code>51.477</code> is the <em>latitude</em> of the southern edge.</li>
<li><code>-0.001</code> is the <em>longitude</em> of the western edge.</li>
<li><code>51.478</code> is the <em>latitude</em> of the norther edge.</li>
<li><code>0.001</code> is the <em>longitude</em> of the eastern edge.</li>
</ul>

<p>The Overpass API only uses the decimal fraction notation,
a notation in minutes and seconds is not supported.</p>

<p>The value of the southern edge must be always smaller than the value of the northern edge,
because the values for degree of latitude are growing from the south pole to the north pole,
from -90.0 to +90.0.</p>

<p>In contrast to this, the values for degree of longitude are growing from west to east almost everywhere.
But at the antimeridian the values jumps from +180.0 to -180.0.
The antimeridian crosses on its way from the north pole to the south pole the pacific and not much else.
Thus, in almost all cases the value of the western edge is smaller than the value of the eastern edge,
unless one really wants to span a bounding box across the antimeridian.</p>

<p>It usually is tedious
to manually figure out the bounding box.
For this reason, almost all of the at <a href="../targets/index.html">Downstream Tools</a> listed tools have convenience features for this.
In <a href="../targets/turbo.html#convenience">Overpass Turbo</a> and also <a href="../targets/index.html">JOSM</a>,
the substring <code>{{bbox}}</code> is replaced by the bounding box of the viewport.
Thus, one can work with a generalized query like <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=16&amp;Q=nwr%28%7B%7Bbbox%7D%7D%29%3B%0Aout%3B">this</a>:</p>

<pre>
<codeline>nwr({{bbox}});</codeline>
<codeline>out;</codeline>
</pre>

<p>The query then always is executed in the then current visible bounding box.</p>

<p>Please note that some of the elements are presented as dashed.
This is a telltale sign of a bigger phenomenon,
and we will pursue that further <a href="osm_types.html">in the next section</a>:
The objects in question have been completely delivered with regard to their syntactic structure,
but they have incomplete geometry because we implicitly specified so in this query.</p>

<p><a name="crop"/></p>

<h2>Crop Output</h2>

<p>There is a second purpose that bounding boxes are used for:
The output of <code>out geom</code> can be spatially restricted.
If one wants to visualize a <em>way</em> or <em>relation</em> on a map,
then one must <a href="../targets/formats.html#extras">explicitly instruct</a> the Overpass API to add coordinates,
deviating from the design of the OSM data model.</p>

<p>In the case of relations this can lead to big amounts of data.
As a quite typical example,
in <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=16&amp;Q=relation%2851%2E477%2C%2D0%2E001%2C51%2E478%2C0%2E001%29%3B%0Aout%20geom%3B">this case</a> geometry across half of England is delivered,
although only a couple of hundreds of square meters had been in focus:</p>

<pre>
<codeline>relation(51.477,-0.001,51.478,0.001);</codeline>
<codeline>out geom;</codeline>
</pre>

<p>The amount of data can be reduced
by <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=16&amp;Q=relation%2851%2E477%2C%2D0%2E001%2C51%2E478%2C0%2E001%29%3B%0Aout%20geom%2851%2E47%2C%2D0%2E01%2C51%2E49%2C0%2E01%29%3B">explicitly stating</a> a bounding box to apply:</p>

<pre>
<codeline>relation(51.477,-0.001,51.478,0.001);</codeline>
<codeline>out geom(51.47,-0.01,51.49,0.01);</codeline>
</pre>

<p>The bounding box must be written immediately after <code>geom</code>.
It can be equal or different from bounding boxes in our statements of the same request.
In this case we have opted for a very broad spare boundary
by using a larger bounding box for the output than for the query.</p>

<p>For explicitly output <em>nodes</em> the coordinate then is exactly delivered
if the node is inside the bounding box.</p>

<p>For <em>ways</em>, not only the coordinates of the <em>nodes</em> within the bounding box are printed,
but always also the next and preceding coordinate
even if the respective coordinate is already outside the bounding box.
To see this in <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=18&amp;Q=way%5Bname%3D%22Blackheath%20Avenue%22%5D%2851%2E477%2C%2D0%2E001%2C51%2E478%2C0%2E001%29%3B%0Aout%20geom%2851%2E477%2C%2D0%2E002%2C51%2E479%2C0%2E002%29%3B">an example</a>,
please click after executing the request in the upper right corner on <em>data</em>.
Panning the map around shows where the geometry has been cut:</p>

<pre>
<codeline>way[name="Blackheath Avenue"](51.477,-0.001,51.478,0.001);</codeline>
<codeline>out geom(51.477,-0.002,51.479,0.002);</codeline>
</pre>

<p>Only part of the <em>nodes</em> have coordinates in this example.</p>

<p>The parts that have coordinates of each single the way <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4735&amp;lon=-0.007&amp;zoom=17&amp;Q=way%5Bname%3D%22Hyde%20Vale%22%5D%3B%0Aout%20geom%2851%2E472%2C%2D0%2E009%2C51%2E475%2C%2D0%2E005%29%3B">can be unconnected</a>, even within a single way:</p>

<pre>
<codeline>way[name="Hyde Vale"];</codeline>
<codeline>out geom(51.472,-0.009,51.475,-0.005);</codeline>
</pre>

<p>The phenomenon already happens
if a way makes a moderate curve out of the bounding box and later again into it
like in this example.</p>

<p>For <em>relations</em> their <em>members</em> of type <em>way</em> are expanded
if at least one of the <em>nodes</em> of the respective way is inside the bounding box.
Other <em>members</em> of type <em>way</em> are not expanded.
Within these <em>ways</em>, like for <em>ways</em> themselves,
the referred <em>nodes</em> within the bounding box plus one extra <em>node</em> are amended with coordinates.</p>

<p>Like with the bounding box as a filter,
most programs have a mechanism to automatically insert the bounding box of the viewport.
In <a href="../targets/turbo.html#convenience">Overpass Turbo</a> again the substring <code>{{bbox}}</code> is replaced by the current bounding box, <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=16&amp;Q=relation%28%7B%7Bbbox%7D%7D%29%3B%0Aout%20geom%28%7B%7Bbbox%7D%7D%29%3B">e.g.</a>:</p>

<pre>
<codeline>relation({{bbox}});</codeline>
<codeline>out geom({{bbox}});</codeline>
</pre>

<p><a name="global"/></p>

<h2>Filter Globally</h2>

<p>...</p>
<hr/>
<p>next: <a href="osm_types.html">Geometries</a></p>

</body>
</html>

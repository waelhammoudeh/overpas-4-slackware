<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml">
<head><meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
pre { background-color:#ccffff; padding: 0.5em; counter-reset: line; }
div[type=sibling] { text-indent:1em; }
codeline::before { counter-increment: line; content: counter(line)" "; color: #99cccc; }
</style>
  <title>Rectangle englobant</title>
</head>
<body style="font-family:sans-serif; max-width:32em">

<p><a href="../index.html">Mode d'emploi d'API Overpass</a>  </p>

<nav>
<div type="parent"><a href="../preface/index.html">Introduction</a></div>
<div type="parent"><a href="../targets/index.html">Utilisation</a></div>
<div type="parent"><strong><a href="index.html">Toutes les données dans une région</a></strong></div>

<div type="sibling"><strong> Rectangle englobant</strong></div>
<div type="sibling"><a href="osm_types.html">Des géométries</a></div>
<div type="sibling"><a href="map_apis.html">Autres APIs disponibles</a></div>
<div type="sibling"><a href="polygon.html">Polygone et autour</a></div>
<div type="sibling"><a href="area.html">Requêter par surface</a></div>
<div type="sibling"><a href="other_sources.html">Alternatives</a></div>

</nav>
<div type="parent"><a href="../criteria/index.html">Trouver des objets</a></div>
<div type="parent"><a href="../counting/index.html">Compter d'objets</a></div>
<div type="parent"><a href="../analysis/index.html">Analyser des données</a></div>
<div type="parent"><a href="../more_info/index.html">Plus d'informations</a></div>

<hr />

<h1>Rectangle englobant</h1>

<p>Obtenir des données d'OpenStreetMap dans un extrait de la façon la plus simple.</p>

<nav>
<h3>Sommaire</h3>

<div type="subsection"><a href="bbox.html#filter">Le filtre</a></div>
<div type="subsection"><a href="bbox.html#crop">Restriction d'affichage</a></div>
<div type="subsection"><a href="bbox.html#global">Rectangle globale de délimitation</a></div>

</nav>

<p><a name="filter"/></p>

<h2>Le filtre</h2>

<p>La façon la plus simple d'obtenir toutes les données dans un rectangle englobant est,
de ça <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=16&amp;Q=nwr%2851%2E477%2C%2D0%2E001%2C51%2E478%2C0%2E001%29%3B%0Aout%3B">formuler explicitement</a>:</p>

<pre>
<codeline>nwr(51.477,-0.001,51.478,0.001);</codeline>
<codeline>out;</codeline>
</pre>

<p>Où <code>(51.477,-0.001,51.478,0.001)</code> représente le rectangle englobant.
L'ordre des bords dans l'expression est toujours le même:</p>

<ul>
<li><code>51.477</code> est la latitude de la frontière sud</li>
<li><code>-0.001</code> est la longitude de la frontière ouest</li>
<li><code>51.478</code> est la latitude de la frontière sud</li>
<li><code>0.001</code> est la longitude de la frontière est</li>
</ul>

<p>L'API Overpass utilise uniquement des fractions décimales,
la notation minute-seconde ou la notation de fraction minute-décimale n'est pas supportée.</p>

<p>La valeur de la frontière sud doit toujours être inférieure à celle de la frontière nord,
comme dans le système de coordonnées latitude-longitude, les degrés augmentent du pôle Sud au pôle Nord, de -90,0 à +90,0.</p>

<p>Les longitudes augmentent d'ouest en est aussi presque partout.
Mais il y a l'antiméridien -
là la valeur de longitude passe de +180,0 à -180,0.
Conclusion: Dans presque tous les cas, la valeur ouest est inférieure à la valeur est,
à moins que vous ne vouliez étirer un rectangle englobant à travers l'Antiméridien.</p>

<p>C'est généralement assez fastidieux,
pour trouver le bon rectangle englobant vous-même.
C'est pourquoi presque tous les programmes décrits sous <a href="../targets/index.html">Usage</a> ont des fonctions de confort pour cela.
Pour <a href="../targets/turbo.html#convenience">Overpass Turbo</a> et aussi <a href="../targets/index.html">JOSM</a>
toutes les occurrences de la chaîne de caractères <code>{{bbox}}</code> sont remplacées par le rectangle englobant visible avant que la requête ne soit envoyée. Avec ceci vous pouvez écrire une requête comme ci-dessus plus générale que <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=16&amp;Q=nwr%28%7B%7Bbbox%7D%7D%29%3B%0Aout%3B">(Lien)</a></p>

<pre>
<codeline>nwr({{bbox}});</codeline>
<codeline>out;</codeline>
</pre>

<p>La requête prend alors effet dans le rectangle englobant visible correspondante.</p>

<p>Notez que certains éléments sont en pointillés sur l'affichage.
C'est un indice d'un plus gros problème que nous allons explorer <a href="osm_types.html">dans la prochaine section</a>:
Des objets formellement complets seront livrés,
mais ces objets ont des géométries incomplètes,
parce que nous l'avons spécifié dans la requête.</p>

<p><a name="crop"/></p>

<h2>Restriction d'affichage</h2>

<p>Une deuxième situation dans laquelle il y a des rectangles englobants,
est <code>out geom</code> pour la limite de sortie.
Si vous voulez visualiser une <em>chemin</em> ou une <em>relation</em> sur la carte,
vous devez <a href="../targets/formats.html#extras">indiquer explicitement</a> l'API Overpass
d'équiper l'objet de coordonnées contraires aux conventions de l'OSM.</p>

<p>Dans le cas des relations, cela peut conduire à de grandes quantités de données.
Ainsi, dans <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=16&amp;Q=relation%2851%2E477%2C%2D0%2E001%2C51%2E478%2C0%2E001%29%3B%0Aout%20geom%3B">cet exemple</a>, la géométrie est livrée sans demande dans toute l'Angleterre,
bien que seulement quelques centaines de mètres carrés aient été mis au point:</p>

<pre>
<codeline>relation(51.477,-0.001,51.478,0.001);</codeline>
<codeline>out geom;</codeline>
</pre>

<p>La quantité de données peut être limitée,
en ne demandant <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=16&amp;Q=relation%2851%2E477%2C%2D0%2E001%2C51%2E478%2C0%2E001%29%3B%0Aout%20geom%2851%2E47%2C%2D0%2E01%2C51%2E49%2C0%2E01%29%3B">explicitement</a> que les coordonnées de le rectangle englobant donné dans l'instruction de sortie:</p>

<pre>
<codeline>relation(51.477,-0.001,51.478,0.001);</codeline>
<codeline>out geom(51.47,-0.01,51.49,0.01);</codeline>
</pre>

<p>Le rectangle englobant est notée directement derrière <code>geom</code>.
Il peut être identique ou différente de celle des rectangles englobants des instructions précédentes.
Dans ce cas, nous avons décidé d'utiliser une réserve très large en utilisant différents rectangles englobants.</p>

<p>Pour les <em>nœuds</em> se produisant explicitement,
les coordonnées sont fournies exactement à ce moment-là,
si elles sont à l'intérieur du rectangle englobant.</p>

<p>Avec <em>chemins</em>, ce ne sont pas seulement les coordonnées de tous les <em>nœuds</em> du rectangle englobant qui sont fournies,
mais aussi la coordonnée suivante et précédente,
même s'il est déjà en dehors du rectangle englobant.
Pour voir ceci <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=18&amp;Q=way%5Bname%3D%22Blackheath%20Avenue%22%5D%2851%2E477%2C%2D0%2E001%2C51%2E478%2C0%2E001%29%3B%0Aout%20geom%2851%2E477%2C%2D0%2E002%2C51%2E479%2C0%2E002%29%3B">dans l'exemple</a>, veuillez cliquer sur <em>Données</em> dans le coin supérieur droit après exécution;
le déplacement de la carte indique également l'endroit où elle a été coupée:</p>

<pre>
<codeline>way[name="Blackheath Avenue"](51.477,-0.001,51.478,0.001);</codeline>
<codeline>out geom(51.477,-0.002,51.479,0.002);</codeline>
</pre>

<p>Seule une partie des <em>nœuds</em> dans le <em>chemin</em> a des coordonnées ici.</p>

<p>Les sections du chemin avec les coordonnées <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4735&amp;lon=-0.007&amp;zoom=17&amp;Q=way%5Bname%3D%22Hyde%20Vale%22%5D%3B%0Aout%20geom%2851%2E472%2C%2D0%2E009%2C51%2E475%2C%2D0%2E005%29%3B">peuvent être déconnectées</a>,
même dans un seul chemin:</p>

<pre>
<codeline>way[name="Hyde Vale"];</codeline>
<codeline>out geom(51.472,-0.009,51.475,-0.005);</codeline>
</pre>

<p>Une courbe modérée à partir du rectangle englobant et retour est suffisante pour cela, comme dans cet exemple.</p>

<p>Avec <em>relations</em>, un <em>membre</em> du type <em>chemin</em> est allongé,
si au moins l'un des <em>nœuds</em> de cet chemin se trouve à l'intérieur du rectangle englobant.
Les autres <em>membres</em> de type <em>chemin</em> ne sont pas allongés.
Dans ces <em>chemins</em>, les <em>nœuds</em> du rectangle englobant plus un <em>nœud</em> extra sont fournis avec des coordonnées, comme pour les <em>chemins</em> individuels.</p>

<p>Comme avec le rectangle englobant comme filtre, la plupart des programmes ont un mécanisme,
pour insérer automatiquement la boîte de délimitation.
Avec <a href="../targets/turbo.html#convenience">Overpass Turbo</a> cela fait comme ci-dessus <code>{{bbox}}</code>, <a target="_blank" rel="noopener" href="https://overpass-turbo.eu/?lat=51.4775&amp;lon=0.0&amp;zoom=16&amp;Q=relation%28%7B%7Bbbox%7D%7D%29%3B%0Aout%20geom%28%7B%7Bbbox%7D%7D%29%3B">(exemple)</a>:</p>

<pre>
<codeline>relation({{bbox}});</codeline>
<codeline>out geom({{bbox}});</codeline>
</pre>

<p><a name="global"/></p>

<h2>Rectangle globale de délimitation</h2>

<p>...</p>

<!-- Traduit avec www.DeepL.com/Translator, partiellement redigé -->
<hr/>
<p>prochaine: <a href="osm_types.html">Des géométries</a></p>

</body>
</html>
